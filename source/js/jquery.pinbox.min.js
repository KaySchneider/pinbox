(function(a){var h={afterLoad:function(b){if(!0==a.fn.pinbox.staticInfo.isRun)return 1;a.fn.pinbox.staticInfo.isRun=!0;container=a(b.subcontainer+"."+b.newitemindicator,a(this));var e=h.buildMatrix.apply(this,[container,b]);h.setPositions.apply(this,[e,b]);return container},buildMatrix:function(b,e){var d=[],c=[],h=e.rowsize,f=0;a(b).each(function(){f++;c.push(this);f===h&&(f=0,d.push(c),c=[])});0<c.length&&d.push(c);return d},setPositions:function(b,e){var d=a.fn.pinbox.staticInfo,c=h;a(b).each(function(b){a(this).each(function(f){if(0<
b){!1!==d.nextFillMatrixId&&(f=d.nextFillMatrixId);var g=c.getParentItem(f),g=c.builPosPositionFromMaxParent(g.top,a(g.height).outerHeight(!0));left=f*a(this).outerWidth(!0)+10;a(this).attr("subpos",f)}else!1!=d.nextFillMatrixId&&(f=d.nextFillMatrixId),g=!1!=c.getLastPosition(f)?c.getLastPosition(f):0,left=f*a(this).outerWidth(!0)+10;a(this).css({position:"absolute",top:g+"px",left:left+"px"});a(this).removeClass(e.newitemindicator);c.setParentItem(f,this,g);c.setLastPosition(f,g+a(this).outerHeight(!0)+
30);!0!=d.firstRun&&c.checkV()});d.firstRun=!1});d.isRun=!1;return this},getParentItem:function(b){return a.fn.pinbox.staticInfo.parentPosition[b]},setParentItem:function(b,e,d){a.fn.pinbox.staticInfo.parentPosition[b]={height:e,top:d}},checkV:function(){var b=this.minItem(a.fn.pinbox.staticInfo.lastScrollIndex),e=this.maxItem(a.fn.pinbox.staticInfo.lastScrollIndex)[1]-b[1];a.fn.pinbox.staticInfo.nextFillMatrixId=a.fn.pinbox.staticInfo.containerMaxDiff<=e?b[0]:!1},maxItem:function(b){for(var a=b[0],
d=0,c=1;c<b.length;c++)b[c]>a&&(a=b[c],d=c);return[d,a]},minItem:function(b){for(var a=b[0],d=0,c=1;c<b.length;c++)b[c]<a&&(a=b[c],d=c);return[d,a]},getLastPosition:function(b){return!1==a.fn.pinbox.staticInfo.lastScrollIndex||void 0===a.fn.pinbox.staticInfo.lastScrollIndex[b]?!1:a.fn.pinbox.staticInfo.lastScrollIndex[b]},setLastPosition:function(b,e){!1==a.fn.pinbox.staticInfo.lastScrollIndex&&(a.fn.pinbox.staticInfo.lastScrollIndex=[]);a.fn.pinbox.staticInfo.lastScrollIndex[b]=e},builPosPositionFromMaxParent:function(a,
e){return a+e+30},destroy:function(){return this.each(function(){var b=a(this),e=b.data("tooltip");a(window).unbind(".tooltip");e.tooltip.remove();b.removeData("tooltip")})}};a.fn.pinbox=function(b){b=jQuery.extend({},a.fn.pinbox.defaults,b);return h.afterLoad.apply(this,[b])};a.fn.pinbox.staticInfo={isRun:!1,lastScrollIndex:!1,containerMaxDiff:150,nextFillMatrixId:!1,parentPosition:[],firstRun:!0};a.fn.pinbox.defaults={newitemindicator:"new",subcontainer:".prodcont",rowsize:5}})(jQuery);